# 🚀 Bagus Browser v5.0.0 - Plano de Desenvolvimento

## 🎯 Objetivo

Migrar o Bagus Browser para **WebKitGTK 6.0** e **GTK4**, trazendo suporte completo a tecnologias modernas incluindo **WebRTC** (Google Meet, Teams, Zoom).

## 📊 Mudanças Principais

### 🔄 Migrações de Tecnologia

| Componente | v4.x | v5.0.0 |
|------------|------|--------|
| WebKit | webkit2gtk-4.0 (2.48.7) | webkitgtk-6.0 (2.48.7) |
| GTK | GTK3 | GTK4 |
| WebRTC | ❌ Não suportado | ✅ Suportado |
| API Headers | `webkit2/webkit2.h` | `webkit/webkit.h` |

### ✨ Novas Funcionalidades

1. **WebRTC Completo** ✅
   - RTCPeerConnection
   - RTCDataChannel
   - MediaStream API completa
   - Google Meet funcionando
   - Microsoft Teams (web)
   - Zoom (web)
   - Discord (chamadas)

2. **GTK4 Moderno** ✅
   - Widgets modernos
   - Melhor performance
   - Suporte a Wayland nativo
   - Animações suaves

3. **APIs Atualizadas** ✅
   - WebGL 2.0
   - WebAudio melhorado
   - Fetch API completa
   - Service Workers

## 🔧 Mudanças Técnicas Necessárias

### 1. Dependências do Sistema

**Remover**:
```bash
libwebkit2gtk-4.0-dev
libgtk-3-dev
```

**Adicionar**:
```bash
libwebkitgtk-6.0-dev  # Já instalado ✅
libgtk-4-dev
```

### 2. Código C (CGo)

**Headers**:
```c
// Antes (v4.x)
#cgo pkg-config: webkit2gtk-4.0 gtk+-3.0
#include <webkit2/webkit2.h>
#include <gtk/gtk.h>

// Depois (v5.0.0)
#cgo pkg-config: webkitgtk-6.0 gtk4
#include <webkit/webkit.h>
#include <gtk/gtk.h>
```

**Funções que mudaram**:
- `gtk_widget_destroy()` → `gtk_window_destroy()`
- `webkit_web_view_new()` → Mesma API
- `webkit_web_context_get_cookie_manager()` → API diferente
- Sinais GTK podem ter mudado

### 3. Código Go

**gotk3 → gotk4**:
```go
// Antes
import "github.com/gotk3/gotk3/gtk"

// Depois
import "github.com/diamondburned/gotk4/pkg/gtk/v4"
```

**Nota**: Precisaremos usar `gotk4` que é a biblioteca Go para GTK4.

### 4. Build System

**go.mod**:
```go
require (
    github.com/diamondburned/gotk4/pkg/gtk/v4 v0.x.x
    github.com/diamondburned/gotk4/pkg/glib/v2 v0.x.x
    golang.org/x/crypto v0.43.0
)
```

**scripts/bagus**:
```bash
# Atualizar verificação de dependências
pkg-config --exists webkitgtk-6.0
pkg-config --exists gtk4
```

## 📝 Checklist de Migração

### Fase 1: Preparação
- [x] Instalar WebKitGTK 6.0
- [ ] Instalar GTK4 dev
- [ ] Pesquisar biblioteca Go para GTK4
- [ ] Criar branch `v5.0.0-dev`
- [ ] Documentar mudanças de API

### Fase 2: Migração de Código
- [ ] Atualizar todos os `#cgo pkg-config`
- [ ] Atualizar todos os `#include`
- [ ] Migrar widgets GTK3 → GTK4
- [ ] Atualizar APIs do WebKit
- [ ] Corrigir callbacks e sinais

### Fase 3: Testes
- [ ] Compilação sem erros
- [ ] Navegação básica
- [ ] Abas (criar, fechar, alternar)
- [ ] Downloads
- [ ] Favoritos
- [ ] Sessões
- [ ] YouTube
- [ ] **Google Meet** ⭐
- [ ] Configurações
- [ ] Privacidade

### Fase 4: Polimento
- [ ] Atualizar documentação
- [ ] Atualizar README
- [ ] Criar CHANGELOG v5.0.0
- [ ] Testar em diferentes distribuições
- [ ] Criar pacotes .deb
- [ ] Release no GitHub

## 🎨 Pilares Mantidos

### 🔒 Segurança
- ✅ Zero telemetria
- ✅ Sem analytics
- ✅ Sem crash reports
- ✅ Criptografia AES-256-GCM
- ✅ Favoritos criptografados
- ✅ Sessões criptografadas

### 🛡️ Privacidade
- ✅ Do Not Track
- ✅ Third-party cookies bloqueados
- ✅ Geolocalização bloqueada (configurável)
- ✅ DuckDuckGo padrão
- ✅ Sem rastreamento

### 💪 Robustez
- ✅ Gerenciamento de memória
- ✅ Cache de vídeos
- ✅ Restauração de sessão
- ✅ Tratamento de erros

## 📦 Compatibilidade

### Sistemas Suportados (v5.0.0)

| Distro | Versão | Status |
|--------|--------|--------|
| Ubuntu | 22.04+ | ✅ Suportado |
| Debian | 12+ | ✅ Suportado |
| Fedora | 38+ | ✅ Suportado |
| Arch | Rolling | ✅ Suportado |
| Pop!_OS | 22.04+ | ✅ Suportado |

**Nota**: Sistemas mais antigos devem usar Bagus Browser v4.x

### Requisitos Mínimos

- **GTK**: >= 4.0
- **WebKitGTK**: >= 6.0
- **Go**: >= 1.21
- **glibc**: >= 2.35

## 🚧 Desafios Conhecidos

### 1. Biblioteca Go para GTK4
- `gotk3` não suporta GTK4
- Precisamos usar `gotk4` (diamondburned/gotk4)
- API pode ser diferente
- Requer reescrever código de UI

### 2. APIs Quebradas
- Algumas funções do WebKit mudaram
- Cookies manager tem API diferente
- Sinais podem ter nomes diferentes

### 3. Testes
- Testar em múltiplas distribuições
- Garantir que Google Meet funciona
- Verificar performance

## 📅 Timeline Estimado

- **Semana 1**: Preparação e pesquisa
- **Semana 2-3**: Migração de código
- **Semana 4**: Testes e correções
- **Semana 5**: Polimento e documentação
- **Semana 6**: Release v5.0.0

## 🎯 Critérios de Sucesso

1. ✅ Google Meet funciona completamente
2. ✅ Todas as funcionalidades v4.x mantidas
3. ✅ Performance igual ou melhor
4. ✅ Zero regressões
5. ✅ Documentação completa

## 📚 Referências

- [WebKitGTK 6.0 Documentation](https://webkitgtk.org/reference/webkit2gtk/stable/)
- [GTK4 Documentation](https://docs.gtk.org/gtk4/)
- [gotk4 Library](https://github.com/diamondburned/gotk4)
- [WebRTC in WebKit](https://webkit.org/blog/7763/a-closer-look-into-webrtc/)

---

**Status**: 🚧 Em Desenvolvimento  
**Versão Alvo**: 5.0.0  
**Data Início**: 29/10/2025  
**Responsável**: Bagus Browser Team

# ğŸš€ Bagus Browser v5.0.0 - Plano de Desenvolvimento

## ğŸ¯ Objetivo

Migrar o Bagus Browser para **WebKitGTK 6.0** e **GTK4**, trazendo suporte completo a tecnologias modernas incluindo **WebRTC** (Google Meet, Teams, Zoom).

## ğŸ“Š MudanÃ§as Principais

### ğŸ”„ MigraÃ§Ãµes de Tecnologia

| Componente | v4.x | v5.0.0 |
|------------|------|--------|
| WebKit | webkit2gtk-4.0 (2.48.7) | webkitgtk-6.0 (2.48.7) |
| GTK | GTK3 | GTK4 |
| WebRTC | âŒ NÃ£o suportado | âœ… Suportado |
| API Headers | `webkit2/webkit2.h` | `webkit/webkit.h` |

### âœ¨ Novas Funcionalidades

1. **WebRTC Completo** âœ…
   - RTCPeerConnection
   - RTCDataChannel
   - MediaStream API completa
   - Google Meet funcionando
   - Microsoft Teams (web)
   - Zoom (web)
   - Discord (chamadas)

2. **GTK4 Moderno** âœ…
   - Widgets modernos
   - Melhor performance
   - Suporte a Wayland nativo
   - AnimaÃ§Ãµes suaves

3. **APIs Atualizadas** âœ…
   - WebGL 2.0
   - WebAudio melhorado
   - Fetch API completa
   - Service Workers

## ğŸ”§ MudanÃ§as TÃ©cnicas NecessÃ¡rias

### 1. DependÃªncias do Sistema

**Remover**:
```bash
libwebkit2gtk-4.0-dev
libgtk-3-dev
```

**Adicionar**:
```bash
libwebkitgtk-6.0-dev  # JÃ¡ instalado âœ…
libgtk-4-dev
```

### 2. CÃ³digo C (CGo)

**Headers**:
```c
// Antes (v4.x)
#cgo pkg-config: webkit2gtk-4.0 gtk+-3.0
#include <webkit2/webkit2.h>
#include <gtk/gtk.h>

// Depois (v5.0.0)
#cgo pkg-config: webkitgtk-6.0 gtk4
#include <webkit/webkit.h>
#include <gtk/gtk.h>
```

**FunÃ§Ãµes que mudaram**:
- `gtk_widget_destroy()` â†’ `gtk_window_destroy()`
- `webkit_web_view_new()` â†’ Mesma API
- `webkit_web_context_get_cookie_manager()` â†’ API diferente
- Sinais GTK podem ter mudado

### 3. CÃ³digo Go

**gotk3 â†’ gotk4**:
```go
// Antes
import "github.com/gotk3/gotk3/gtk"

// Depois
import "github.com/diamondburned/gotk4/pkg/gtk/v4"
```

**Nota**: Precisaremos usar `gotk4` que Ã© a biblioteca Go para GTK4.

### 4. Build System

**go.mod**:
```go
require (
    github.com/diamondburned/gotk4/pkg/gtk/v4 v0.x.x
    github.com/diamondburned/gotk4/pkg/glib/v2 v0.x.x
    golang.org/x/crypto v0.43.0
)
```

**scripts/bagus**:
```bash
# Atualizar verificaÃ§Ã£o de dependÃªncias
pkg-config --exists webkitgtk-6.0
pkg-config --exists gtk4
```

## ğŸ“ Checklist de MigraÃ§Ã£o

### Fase 1: PreparaÃ§Ã£o
- [x] Instalar WebKitGTK 6.0
- [ ] Instalar GTK4 dev
- [ ] Pesquisar biblioteca Go para GTK4
- [ ] Criar branch `v5.0.0-dev`
- [ ] Documentar mudanÃ§as de API

### Fase 2: MigraÃ§Ã£o de CÃ³digo
- [ ] Atualizar todos os `#cgo pkg-config`
- [ ] Atualizar todos os `#include`
- [ ] Migrar widgets GTK3 â†’ GTK4
- [ ] Atualizar APIs do WebKit
- [ ] Corrigir callbacks e sinais

### Fase 3: Testes
- [ ] CompilaÃ§Ã£o sem erros
- [ ] NavegaÃ§Ã£o bÃ¡sica
- [ ] Abas (criar, fechar, alternar)
- [ ] Downloads
- [ ] Favoritos
- [ ] SessÃµes
- [ ] YouTube
- [ ] **Google Meet** â­
- [ ] ConfiguraÃ§Ãµes
- [ ] Privacidade

### Fase 4: Polimento
- [ ] Atualizar documentaÃ§Ã£o
- [ ] Atualizar README
- [ ] Criar CHANGELOG v5.0.0
- [ ] Testar em diferentes distribuiÃ§Ãµes
- [ ] Criar pacotes .deb
- [ ] Release no GitHub

## ğŸ¨ Pilares Mantidos

### ğŸ”’ SeguranÃ§a
- âœ… Zero telemetria
- âœ… Sem analytics
- âœ… Sem crash reports
- âœ… Criptografia AES-256-GCM
- âœ… Favoritos criptografados
- âœ… SessÃµes criptografadas

### ğŸ›¡ï¸ Privacidade
- âœ… Do Not Track
- âœ… Third-party cookies bloqueados
- âœ… GeolocalizaÃ§Ã£o bloqueada (configurÃ¡vel)
- âœ… DuckDuckGo padrÃ£o
- âœ… Sem rastreamento

### ğŸ’ª Robustez
- âœ… Gerenciamento de memÃ³ria
- âœ… Cache de vÃ­deos
- âœ… RestauraÃ§Ã£o de sessÃ£o
- âœ… Tratamento de erros

## ğŸ“¦ Compatibilidade

### Sistemas Suportados (v5.0.0)

| Distro | VersÃ£o | Status |
|--------|--------|--------|
| Ubuntu | 22.04+ | âœ… Suportado |
| Debian | 12+ | âœ… Suportado |
| Fedora | 38+ | âœ… Suportado |
| Arch | Rolling | âœ… Suportado |
| Pop!_OS | 22.04+ | âœ… Suportado |

**Nota**: Sistemas mais antigos devem usar Bagus Browser v4.x

### Requisitos MÃ­nimos

- **GTK**: >= 4.0
- **WebKitGTK**: >= 6.0
- **Go**: >= 1.21
- **glibc**: >= 2.35

## ğŸš§ Desafios Conhecidos

### 1. Biblioteca Go para GTK4
- `gotk3` nÃ£o suporta GTK4
- Precisamos usar `gotk4` (diamondburned/gotk4)
- API pode ser diferente
- Requer reescrever cÃ³digo de UI

### 2. APIs Quebradas
- Algumas funÃ§Ãµes do WebKit mudaram
- Cookies manager tem API diferente
- Sinais podem ter nomes diferentes

### 3. Testes
- Testar em mÃºltiplas distribuiÃ§Ãµes
- Garantir que Google Meet funciona
- Verificar performance

## ğŸ“… Timeline Estimado

- **Semana 1**: PreparaÃ§Ã£o e pesquisa
- **Semana 2-3**: MigraÃ§Ã£o de cÃ³digo
- **Semana 4**: Testes e correÃ§Ãµes
- **Semana 5**: Polimento e documentaÃ§Ã£o
- **Semana 6**: Release v5.0.0

## ğŸ¯ CritÃ©rios de Sucesso

1. âœ… Google Meet funciona completamente
2. âœ… Todas as funcionalidades v4.x mantidas
3. âœ… Performance igual ou melhor
4. âœ… Zero regressÃµes
5. âœ… DocumentaÃ§Ã£o completa

## ğŸ“š ReferÃªncias

- [WebKitGTK 6.0 Documentation](https://webkitgtk.org/reference/webkit2gtk/stable/)
- [GTK4 Documentation](https://docs.gtk.org/gtk4/)
- [gotk4 Library](https://github.com/diamondburned/gotk4)
- [WebRTC in WebKit](https://webkit.org/blog/7763/a-closer-look-into-webrtc/)

---

**Status**: ğŸš§ Em Desenvolvimento  
**VersÃ£o Alvo**: 5.0.0  
**Data InÃ­cio**: 29/10/2025  
**ResponsÃ¡vel**: Bagus Browser Team
